<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scorekort</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #007bff;
        }
        .form-group label {
            font-weight: bold;
        }
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }
        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #004085;
        }
        table {
            margin-top: 20px;
        }
        th {
            background-color: #007bff;
            color: white;
            text-align: center;
        }
        td {
            text-align: center;
        }
        .score-input {
            width: 60px;
            margin: auto;
        }
        .total-row {
            font-weight: bold;
        }
        .total-cell {
            background-color: #e9ecef;
        }
        .form-row {
            margin-bottom: 15px;
        }
        .alert {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="my-4">Scorekort</h1>
        <div class="alert alert-danger" id="errorAlert" role="alert">
            Var vänlig fyll i alla fält.
        </div>
        <div class="form-row">
            <div class="form-group col-md-6">
                <label for="clubSelect">Välj klubb:</label>
                <select class="form-control" id="clubSelect" onchange="loadCourses()">
                    <option value="">Välj klubb</option>
                    <option value="club1">Vasatorp GK</option>
                    <option value="club2">Allerum GK</option>
                    <option value="club3">Barsebäcks Golf & Country Club</option>
                    <!-- Add more clubs as needed -->
                </select>
            </div>
            <div class="form-group col-md-6">
                <label for="courseSelect">Välj bana:</label>
                <select class="form-control" id="courseSelect" onchange="loadCourseDetails()">
                    <option value="">Välj bana</option>
                    <!-- Courses will be loaded dynamically based on selected club -->
                </select>
            </div>
        </div>
        <div class="form-group">
            <label for="numPlayers">Antal spelare:</label>
            <input type="number" class="form-control" id="numPlayers" min="1" placeholder="Ange antal spelare">
        </div>
        <button class="btn btn-primary" onclick="addPlayerNames()">Ange spelarnamn</button>
        <hr>
        <div id="playerNamesForm" class="mt-4">
            <!-- Player names input fields will be generated here -->
        </div>
        <button class="btn btn-primary mt-2" onclick="validateAndCreateScorecard()">Skapa scorekort</button>
        <hr>
        <form id="scorecardForm" class="mt-4">
            <!-- Scorecard will be generated here -->
        </form>
    </div>

    <script>
        const courses = {
            club1: {
                courseA: {
                    name: "TC",
                    pars: [4, 3, 5, 3, 4, 5, 4, 4, 4, 5, 4, 5, 4, 3, 4, 4, 3, 4],
                    indexes: [10, 12, 4, 18, 2, 16, 8, 14, 6, 9, 15, 7, 1, 13, 3, 5, 17, 11]
                },
                courseB: {
                    name: "Classic Course",
                    pars: [5, 4, 4, 3, 5, 4, 3, 4, 4, 4, 5, 4, 4, 3, 4, 4, 3, 5],
                    indexes: [12, 4, 16, 18, 2, 8, 10, 14, 6, 5, 11, 1, 15, 13, 3, 7, 17, 9]
                },
                courseC: {
                    name: "Park Course",
                    par: [3, 4, 4, 5, 3, 4, 3, 4, 4, 3, 5, 3],
                    indexes: [13, 9, 5, 7, 15, 3, 17, 11, 1, 14, 4, 12]
                }
            },
            club2: {
                courseD: {
                    name: "Ängsbanan",
                    pars: [3, 4, 4, 5, 3, 4, 4, 5, 3, 4, 4, 5, 3, 4, 4, 5, 3, 4],
                    indexes: [18, 3, 14, 7, 16, 6, 13, 1, 15, 2, 11, 8, 17, 4, 10, 9, 12, 5]
                }
            },
            club3: {
                courseE: {
                    name: "Ocean Course",
                    pars: [4, 4, 4, 3, 5, 4, 4, 3, 5, 4, 4, 5, 4, 4, 3, 5, 4, 4],
                    indexes: [3, 17, 11, 7, 15, 5, 1, 13, 9, 8, 4, 18, 12, 6, 14, 16, 2, 10]
                }
            }
        };

        function loadCourses() {
            const clubSelect = document.getElementById('clubSelect').value;
            const courseSelect = document.getElementById('courseSelect');
            courseSelect.innerHTML = '<option value="">Välj bana</option>';

            if (clubSelect) {
                const clubCourses = courses[clubSelect];
                for (const courseKey in clubCourses) {
                    if (clubCourses.hasOwnProperty(courseKey)) {
                        const option = document.createElement('option');
                        option.value = courseKey;
                        option.textContent = clubCourses[courseKey].name;
                        courseSelect.appendChild(option);
                    }
                }
            }
        }

        function loadCourseDetails() {
            const clubSelect = document.getElementById('clubSelect').value;
            const courseSelect = document.getElementById('courseSelect').value;

            if (clubSelect && courseSelect) {
                const courseDetails = courses[clubSelect][courseSelect];
                createScorecard(courseDetails);
            }
        }

        function addPlayerNames() {
            const numPlayers = document.getElementById('numPlayers').value;
            const playerNamesForm = document.getElementById('playerNamesForm');
            playerNamesForm.innerHTML = '';

            if (numPlayers > 0) {
                for (let i = 1; i <= numPlayers; i++) {
                    const div = document.createElement('div');
                    div.className = 'form-group';

                    const label = document.createElement('label');
                    label.for = `playerName${i}`;
                    label.textContent = `Spelare ${i} namn:`;

                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'form-control';
                    input.id = `playerName${i}`;
                    input.name = `playerName${i}`;
                    input.placeholder = `Ange namn för spelare ${i}`;

                    div.appendChild(label);
                    div.appendChild(input);
                    playerNamesForm.appendChild(div);
                }
            }
        }

        function validateAndCreateScorecard() {
            const clubSelect = document.getElementById('clubSelect').value;
            const courseSelect = document.getElementById('courseSelect').value;
            const numPlayers = document.getElementById('numPlayers').value;
            const playerNamesForm = document.getElementById('playerNamesForm');

            if (!clubSelect || !courseSelect || !numPlayers || playerNamesForm.innerHTML === '') {
                document.getElementById('errorAlert').style.display = 'block';
            } else {
                document.getElementById('errorAlert').style.display = 'none';
                loadCourseDetails();
            }
        }

        function createScorecard(courseDetails) {
            const numPlayers = document.getElementById('numPlayers').value;
            const scorecardForm = document.getElementById('scorecardForm');
            scorecardForm.innerHTML = '';

            const playerNames = [];
            for (let i = 1; i <= numPlayers; i++) {
                const playerNameInput = document.getElementById(`playerName${i}`);
                playerNames.push(playerNameInput.value || `Spelare ${i}`);
            }

            if (numPlayers > 0 && courseDetails) {
                const table = document.createElement('table');
                table.className = 'table table-bordered';

                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');

                const headers = ['Hål', 'Par', 'Index'];
                playerNames.forEach(name => headers.push(name));
                headers.push('Totalt');

                headers.forEach(headerText => {
                    const th = document.createElement('th');
                    th.textContent = headerText;
                    headerRow.appendChild(th);
                });

                thead.appendChild(headerRow);
                table.appendChild(thead);

                const tbody = document.createElement('tbody');

                for (let hole = 1; hole <= 18; hole++) {
                    const row = document.createElement('tr');

                    const holeCell = document.createElement('td');
                    holeCell.textContent = `${hole}`;
                    row.appendChild(holeCell);

                    const parCell = document.createElement('td');
                    parCell.textContent = courseDetails.pars[hole - 1];
                    row.appendChild(parCell);

                    const indexCell = document.createElement('td');
                    indexCell.textContent = courseDetails.indexes[hole - 1];
                    row.appendChild(indexCell);

                    for (let player = 1; player <= numPlayers; player++) {
                        const scoreCell = document.createElement('td');
                        const input = document.createElement('input');
                        input.type = 'number';
                        input.className = 'form-control score-input';
                        input.name = `player${player}hole${hole}`;
                        input.oninput = calculateTotals;
                        scoreCell.appendChild(input);
                        row.appendChild(scoreCell);
                    }

                    const totalCell = document.createElement('td');
                    totalCell.id = `totalHole${hole}`;
                    row.appendChild(totalCell);

                    tbody.appendChild(row);
                }

                const footerRow = document.createElement('tr');
                footerRow.className = 'total-row';

                const footerCell = document.createElement('td');
                footerCell.textContent = 'Totalt';
                footerRow.appendChild(footerCell);

                for (let player = 1; player <= numPlayers; player++) {
                    const totalScoreCell = document.createElement('td');
                    totalScoreCell.id = `totalPlayer${player}`;
                    totalScoreCell.className = 'total-cell';
                    footerRow.appendChild(totalScoreCell);
                }

                const grandTotalCell = document.createElement('td');
                grandTotalCell.id = 'grandTotal';
                grandTotalCell.className = 'total-cell';
                footerRow.appendChild(grandTotalCell);

                tbody.appendChild(footerRow);
                table.appendChild(tbody);

                scorecardForm.appendChild(table);
            }
        }

        function calculateTotals() {
            const numPlayers = document.getElementById('numPlayers').value;
            let grandTotal = 0;

            for (let player = 1; player <= numPlayers; player++) {
                let playerTotal = 0;

                for (let hole = 1; hole <= 18; hole++) {
                    const scoreInput = document.querySelector(`input[name=player${player}hole${hole}]`);
                    const scoreValue = parseInt(scoreInput.value) || 0;
                    playerTotal += scoreValue;
                }

                document.getElementById(`totalPlayer${player}`).textContent = playerTotal;
                grandTotal += playerTotal;
            }

            document.getElementById('grandTotal').textContent = grandTotal;
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>